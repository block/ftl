#!/bin/bash
set -euo pipefail

# Run go mod tidy on all modules
just tidy

echo "Formatting Go..."
just format-backend

echo "Formatting protobufs..."
just format-protos

# Revert changes to generated files.
find backend/protos \( -name '*.pb.go' -o -name '*.connect.go' \) -print0 | xargs -0 -r git checkout > /dev/null

just pnpm-install

just build-protos

echo "Formatting TypeScript..."
just format-frontend

git diff
